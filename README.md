# Prompt Chooser for ComfyUI

A custom node for ComfyUI that allows you to intercept, preview, and edit prompts during workflow execution, especially useful when working with AI prompt generators or any text-based workflows.

## Features

- Intercepts and displays prompts during workflow execution
- Allows editing of prompts in a modal dialog
- Continues workflow with your modified prompt
- Cancel option to stop the current execution
- Two operation modes: "Always pause" and "Pass through"
- Two specialized nodes:
  - `Prompt Chooser` - General purpose text prompt editor
  - `AI Output Interceptor` - Designed for AI-generated text outputs

## Installation

### Option 1: Manual Installation

1. Navigate to your ComfyUI custom nodes directory:
```bash
cd [path to ComfyUI]/custom_nodes
```

2. Create a new directory for the node:
```bash
mkdir comfyui-prompt-chooser
cd comfyui-prompt-chooser
```

3. Create the necessary files with the code provided:
   - `__init__.py`
   - `prompt_chooser.py`
   - Create a `js` folder and add `prompt_chooser.js` inside it

4. Restart ComfyUI

### Option 2: Git Installation

1. Navigate to your ComfyUI custom nodes directory:
```bash
cd [path to ComfyUI]/custom_nodes
```

2. Clone the repository (if available):
```bash
git clone https://github.com/yourusername/comfyui-prompt-chooser.git
```

3. Restart ComfyUI

## Usage

### Basic Usage with AI Prompt Generators

1. Add an AI prompt generator node to your workflow
2. Connect the output of the AI to the `ai_output` input of an `AI Output Interceptor` node
3. Connect the `prompt` output of the `AI Output Interceptor` to your text-to-image node's prompt input (e.g., CLIPTextEncode)
4. Run your workflow

When the workflow reaches the Prompt Chooser node, it will pause and display a dialog with the prompt generated by the AI. You can edit this prompt and then click "Submit" to continue the workflow with your edited prompt.

### General Purpose Usage

The general-purpose `Prompt Chooser` node can be used anywhere in your workflow where you might want to review and edit text:

1. Connect any text output to the `prompt` input of the `Prompt Chooser` node
2. Connect the `prompt` output of the `Prompt Chooser` to any node that accepts text input
3. Run your workflow to review and edit the text

### Node Inputs

#### AI Output Interceptor:
- `ai_output`: Connect this to the output of your AI prompt generator node
- `mode`: 
  - "Always pause" - Always stop and wait for user input
  - "Pass through" - Skip editing and pass the original text unchanged

#### Prompt Chooser:
- `prompt`: Any text input that you want to be able to edit
- `mode`: Same options as AI Output Interceptor

### Node Outputs

Both nodes output a single `prompt` that contains either the original text (if "Pass through" mode is selected) or your edited text.

## Example Workflows

### AI Prompt Editing Workflow

1. AI Prompt Generator → AI Output Interceptor → CLIPTextEncode → KSampler

### Workflow with Multiple Editable Points

1. Text input → Prompt Chooser → AI Prompt Generator → AI Output Interceptor → CLIPTextEncode → KSampler

This allows you to edit the initial prompt sent to the AI generator, and then edit the AI's output before it goes to the image generation.

## Troubleshooting

- **Dialog doesn't appear**: Check your browser console for any JavaScript errors
- **Node not found in the menu**: Make sure all files are in the correct locations and that you've restarted ComfyUI
- **Workflow gets stuck**: If the workflow seems stuck at the prompt chooser, try clicking the "Cancel current run" button

## Advanced Configuration

The node includes a setting in the ComfyUI settings menu to enable/disable alert sounds when the prompt editor appears.

## Contributing

Feel free to contribute to this project by submitting issues or pull requests.

## License

MIT

## Acknowledgements

This node was inspired by the [Image Chooser](https://github.com/chrisgoringe/cg-image-picker) node by chrisgoringe, adapting the concept to work with text prompts instead of images.
